import{v as m,d as N,z as J,e as V,A as F,H as T,w as H,y as z,o as d,k as B,n as _,B as G,q as f,j as p,r as R,F as w,s as S,ai as A,C as K,p as L}from"./index-daf2c61e.js";import{i as U}from"./boolean-c7e7c785.js";import{w as W}from"./defaults-4d6daddf.js";import{_ as $}from"./Table-985edaf0.js";function I(t){this.message=t}I.prototype=new Error,I.prototype.name="InvalidCharacterError";var E=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new I("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,a=0,i=0,s="";r=e.charAt(i++);~r&&(n=a%4?64*n+r:r,a++%4)?s+=String.fromCharCode(255&n>>(-2*a&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function q(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(E(n).replace(/(.)/g,function(r,a){var i=a.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(e)}catch{return E(e)}}function y(t){this.message=t}function M(t,e){if(typeof t!="string")throw new y("Invalid token specified");var n=(e=e||{}).header===!0?0:1;try{return JSON.parse(q(t.split(".")[n]))}catch(r){throw new y("Invalid token specified: "+r.message)}}y.prototype=new Error,y.prototype.name="InvalidTokenError";var g=Symbol("@ts-pattern/matcher"),O="@ts-pattern/anonymous-select-key",j=function(t){return!!(t&&typeof t=="object")},b=function(t){return t&&!!t[g]},Q=function t(e,n,r){if(j(e)){if(b(e)){var a=e[g]().match(n),i=a.matched,s=a.selections;return i&&s&&Object.keys(s).forEach(function(o){return r(o,s[o])}),i}if(!j(n))return!1;if(Array.isArray(e))return!!Array.isArray(n)&&e.length===n.length&&e.every(function(o,c){return t(o,n[c],r)});if(e instanceof Map)return n instanceof Map&&Array.from(e.keys()).every(function(o){return t(e.get(o),n.get(o),r)});if(e instanceof Set){if(!(n instanceof Set))return!1;if(e.size===0)return n.size===0;if(e.size===1){var u=Array.from(e.values())[0];return b(u)?Array.from(n.values()).every(function(o){return t(u,o,r)}):n.has(u)}return Array.from(e.values()).every(function(o){return n.has(o)})}return Object.keys(e).every(function(o){var c,l=e[o];return(o in n||b(c=l)&&c[g]().matcherType==="optional")&&t(l,n[o],r)})}return Object.is(n,e)};function h(t){var e;return(e={})[g]=function(){return{match:function(n){return{matched:!!t(n)}}}},e}h(function(t){return!0});h(function(t){return typeof t=="string"});h(function(t){return typeof t=="number"});h(function(t){return typeof t=="boolean"});h(function(t){return typeof t=="bigint"});h(function(t){return typeof t=="symbol"});h(function(t){return t==null});function X(t){return new Y(t,[])}var Y=function(){function t(n,r){this.value=void 0,this.cases=void 0,this.value=n,this.cases=r}var e=t.prototype;return e.with=function(){var n=[].slice.call(arguments),r=n[n.length-1],a=[n[0]],i=[];return n.length===3&&typeof n[1]=="function"?(a.push(n[0]),i.push(n[1])):n.length>2&&a.push.apply(a,n.slice(1,n.length-1)),new t(this.value,this.cases.concat([{match:function(s){var u={},o=!!(a.some(function(c){return Q(c,s,function(l,v){u[l]=v})})&&i.every(function(c){return c(s)}));return{matched:o,value:o&&Object.keys(u).length?O in u?u[O]:u:s}},handler:r}]))},e.when=function(n,r){return new t(this.value,this.cases.concat([{match:function(a){return{matched:!!n(a),value:a}},handler:r}]))},e.otherwise=function(n){return new t(this.value,this.cases.concat([{match:function(r){return{matched:!0,value:r}},handler:n}])).run()},e.exhaustive=function(){return this.run()},e.run=function(){for(var n=this.value,r=void 0,a=0;a<this.cases.length;a++){var i=this.cases[a],s=i.match(this.value);if(s.matched){n=s.value,r=i.handler;break}}if(!r){var u;try{u=JSON.stringify(this.value)}catch{u=this.value}throw new Error("Pattern matching error: no pattern matches value "+u)}return r(n,this.value)},t}();const Z={HS256:"HMAC using SHA-256",HS384:"HMAC using SHA-384",HS512:"HMAC using SHA-512",RS256:"RSASSA-PKCS1-v1_5 using SHA-256",RS384:"RSASSA-PKCS1-v1_5 using SHA-384",RS512:"RSASSA-PKCS1-v1_5 using SHA-512",ES256:"ECDSA using P-256 and SHA-256",ES384:"ECDSA using P-384 and SHA-384",ES512:"ECDSA using P-521 and SHA-512",PS256:"RSASSA-PSS using SHA-256 and MGF1 with SHA-256",PS384:"RSASSA-PSS using SHA-384 and MGF1 with SHA-384",PS512:"RSASSA-PSS using SHA-512 and MGF1 with SHA-512",none:"No digital signature or MAC performed"},ee={typ:"Type",alg:"Algorithm",iss:"Issuer",sub:"Subject",aud:"Audience",exp:"Expiration Time",nbf:"Not Before",iat:"Issued At",jti:"JWT ID",name:"Full name",given_name:"Given name(s) or first name(s)",family_name:"Surname(s) or last name(s)",middle_name:"Middle name(s)",nickname:"Casual name",preferred_username:"Shorthand name by which the End-User wishes to be referred to",profile:"Profile page URL",picture:"Profile picture URL",website:"Web page or blog URL",email:"Preferred e-mail address",email_verified:"True if the e-mail address has been verified; otherwise false",gender:"Gender",birthdate:"Birthday",zoneinfo:"Time zone",locale:"Locale",phone_number:"Preferred telephone number",phone_number_verified:"True if the phone number has been verified; otherwise false",address:"Preferred postal address",updated_at:"Time the information was last updated",azp:"Authorized party - the party to which the ID Token was issued",nonce:"Value used to associate a Client session with an ID Token",auth_time:"Time when the authentication occurred",at_hash:"Access Token hash value",c_hash:"Code hash value",acr:"Authentication Context Class Reference",amr:"Authentication Methods References",sub_jwk:"Public key used to check the signature of an ID Token",cnf:"Confirmation",sip_from_tag:"SIP From tag header field parameter value",sip_date:"SIP Date header field value",sip_callid:"SIP Call-Id header field value",sip_cseq_num:"SIP CSeq numeric header field parameter value",sip_via_branch:"SIP Via branch header field parameter value",orig:"Originating Identity String",dest:"Destination Identity String",mky:"Media Key Fingerprint String",events:"Security Events",toe:"Time of Event",txn:"Transaction Identifier",rph:"Resource Priority Header Authorization",sid:"Session ID",vot:"Vector of Trust value",vtm:"Vector of Trust trustmark URL",attest:"Attestation level as defined in SHAKEN framework",origid:"Originating Identifier as defined in SHAKEN framework",act:"Actor",scope:"Scope Values",client_id:"Client Identifier",may_act:"Authorized Actor - the party that is authorized to become the actor",jcard:"jCard data",at_use_nbr:"Number of API requests for which the access token can be used",div:"Diverted Target of a Call",opt:"Original PASSporT (in Full Form)",vc:"Verifiable Credential as specified in the W3C Recommendation",vp:"Verifiable Presentation as specified in the W3C Recommendation",sph:"SIP Priority header field",ace_profile:"ACE profile a token is supposed to be used with.",cnonce:"Client nonce",exi:"Expires in",roles:"Roles",groups:"Groups",entitlements:"Entitlements",token_introspection:"Token introspection response"};function x({jwt:t}){const e=M(t,{header:!0}),n=M(t),r=m.map(e,(i,s)=>D({claim:s,value:i})),a=m.map(n,(i,s)=>D({claim:s,value:i}));return{header:r,payload:a}}function D({claim:t,value:e}){const n=ee[t],r=m.isPlainObject(e)?JSON.stringify(e,null,3):m.toString(e),a=te({claim:t,value:e});return{value:r,friendlyValue:a,claim:t,claimDescription:n}}function te({claim:t,value:e}){return X(t).with("exp","nbf","iat",()=>ne(e)).with("alg",()=>m.isString(e)?Z[e]:void 0).otherwise(()=>{})}function ne(t){if(m.isNil(t))return;const e=new Date(Number(t)*1e3);return`${e.toLocaleDateString()} ${e.toLocaleTimeString()}`}const re={colspan:"2",class:"table-header"},ae={class:"claims"},ie={"font-bold":""},oe={key:0,"ml-2":"","op-70":""},se={key:0,"ml-2":"","op-70":""},ue=N({__name:"jwt-parser",setup(t){const e=J("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"),n=V(()=>W(()=>x({jwt:e.value}),{header:[],payload:[]})),r=[{key:"header",title:"Header"},{key:"payload",title:"Payload"}],a=F({source:e,rules:[{validator:i=>i.length>0&&U(()=>x({jwt:e.value})),message:"Invalid JWT"}]});return(i,s)=>{const u=K,o=$,c=z;return d(),T(c,null,{default:H(()=>[B(u,{value:_(e),"onUpdate:value":s[0]||(s[0]=l=>G(e)?e.value=l:null),label:"JWT to decode",validation:_(a),placeholder:"Put your token here...",rows:"5",multiline:"","raw-text":"",autofocus:"","mb-3":""},null,8,["value","validation"]),_(a).isValid?(d(),T(o,{key:0},{default:H(()=>[f("tbody",null,[(d(),p(w,null,R(r,l=>(d(),p(w,{key:l.key},[f("th",re,S(l.title),1),(d(!0),p(w,null,R(_(n)[l.key],({claim:v,claimDescription:k,friendlyValue:C,value:P})=>(d(),p("tr",{key:v+P},[f("td",ae,[f("span",ie,S(v),1),k?(d(),p("span",oe," ("+S(k)+") ",1)):A("",!0)]),f("td",null,[f("span",null,S(P),1),C?(d(),p("span",se," ("+S(C)+") ",1)):A("",!0)])]))),128))],64))),64))])]),_:1})):A("",!0)]),_:1})}}});const fe=L(ue,[["__scopeId","data-v-a66f36d1"]]);export{fe as default};
