import{l as J}from"./index.8debc66d.js";import{w as D}from"./defaults.0a26f349.js";import{u as Y}from"./validation.b283a4a1.js";import{i as b}from"./boolean.bf21024b.js";import{l as a,F as x,m as N,v as c,_ as X,d as q,M as V,a_ as G,a$ as H,e as v,n as l,o as k,k as A,w as p,b0 as T,z as E,b1 as K,b2 as Q,a8 as W,a9 as Z,y as O,aX as R,a7 as j}from"./index.ca2546a6.js";import{u as w}from"./copy.d5441c8a.js";import{_ as ee}from"./Switch.1070fb6c.js";import{_ as F}from"./FormItem.7d600ca2.js";const te=({diff:e})=>a("div",{class:"diffs-viewer"},[a("ul",null,[$({diff:e,showKeys:!1})])]),$=({diff:e,showKeys:t=!0})=>{const{type:s,status:n}=e;return n==="updated"?oe({diff:e,showKeys:t}):s==="array"?U({diff:e,showKeys:t,showChildrenKeys:!1,openTag:"[",closeTag:"]"}):s==="object"?U({diff:e,showKeys:t,openTag:"{",closeTag:"}"}):se({diff:e,showKeys:t})},se=({diff:e,showKeys:t})=>{const{value:s,key:n,status:o,oldValue:r}=e,i=o==="removed"?r:s;return a("li",null,[a("span",{class:[o,"result"]},[t&&a(x,null,[a("span",{class:"key"},[n]),": "]),C({value:i,status:o})]),N(",")])},oe=({diff:e,showKeys:t})=>{const{value:s,key:n,oldValue:o}=e;return a("li",{class:"updated-line"},[t&&a(x,null,[a("span",{class:"key"},[n]),": "]),C({value:o,status:"removed"}),C({value:s,status:"added"}),N(",")])},U=({diff:e,openTag:t,closeTag:s,showKeys:n,showChildrenKeys:o=!0})=>{const{children:r,key:i,status:_,type:f}=e;return a("li",null,[a("div",{class:[f,_],style:{display:"inline-block"}},[n&&a(x,null,[a("span",{class:"key"},[i]),": "]),t,r.length>0&&a("ul",null,[r.map(u=>$({diff:u,showKeys:o}))]),s+","])])};function ae(e){return c.isNull(e)?"null":JSON.stringify(e)}const C=({value:e,status:t})=>{const s=ae(e),{copy:n}=w({source:s});return a("span",{class:["value",t],onClick:n},[s])};function ne(e,t,{onlyShowDifferences:s=!1}={}){return c.isArray(e)&&c.isArray(t)?{key:"",type:"array",children:L(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:d(e,t)}:c.isObject(e)&&c.isObject(t)?{key:"",type:"object",children:z(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:d(e,t)}:{key:"",type:"value",oldValue:e,value:t,status:d(e,t)}}function z(e,t,{onlyShowDifferences:s=!1}={}){return Object.keys({...e,...t}).map(o=>B(e==null?void 0:e[o],t==null?void 0:t[o],o,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function B(e,t,s,{onlyShowDifferences:n=!1}={}){const o=h(e);return o==="object"?{key:s,type:o,children:z(e,t,{onlyShowDifferences:n}),oldValue:e,value:t,status:d(e,t)}:o==="array"?{key:s,type:o,children:L(e,t,{onlyShowDifferences:n}),value:t,oldValue:e,status:d(e,t)}:{key:s,type:o,value:t,oldValue:e,status:d(e,t)}}function L(e,t,{onlyShowDifferences:s=!1}={}){const n=Math.max(0,e==null?void 0:e.length,t==null?void 0:t.length);return Array.from({length:n},(o,r)=>B(e==null?void 0:e[r],t==null?void 0:t[r],r,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function h(e){return e===null?"value":Array.isArray(e)?"array":typeof e=="object"?"object":"value"}function d(e,t){if(e===void 0)return"added";if(t===void 0)return"removed";const s=h(e)==="object"&&h(t)==="object",n=h(e)==="array"&&h(t)==="array";return c.isEqual(e,t)?"unchanged":s||n?"children-updated":"updated"}const re={key:0},le=q({__name:"diff-viewer",props:{leftJson:null,rightJson:null},setup(e){const t=e;Q(u=>({"0cdd78c3":l(r).text.mutedColor,"679a61a6":l(r).success.colorFaded,"32d9363c":l(r).success.color,"99eccffe":l(r).error.colorFaded,"4b8c61a7":l(r).error.color,"0b2e25a7":l(r).text.baseColor}));const s=V(!1),{leftJson:n,rightJson:o}=G(t),r=H(),i=v(()=>ne(n.value,o.value,{onlyShowDifferences:s.value})),_=v(()=>c.isEqual(n.value,o.value)),f=v(()=>!c.isUndefined(n.value)&&!c.isUndefined(o.value));return(u,m)=>{const g=ee,y=F,P=W,S=Z,I=O;return l(f)?(k(),A("div",re,[a(P,{justify:"center"},{default:p(()=>[a(y,{label:"Only show differences","label-placement":"left"},{default:p(()=>[a(g,{value:l(s),"onUpdate:value":m[0]||(m[0]=M=>T(s)?s.value=M:null)},null,8,["value"])]),_:1})]),_:1}),a(I,{"data-test-id":"diff-result"},{default:p(()=>[l(_)?(k(),E(S,{key:0,depth:"3",block:"","text-center":"",italic:""},{default:p(()=>[N(" The provided JSONs are the same ")]),_:1})):(k(),E(l(te),{key:1,diff:l(i)},null,8,["diff"]))]),_:1})])):K("",!0)}}});var ue=X(le,[["__scopeId","data-v-65850042"]]);const he=q({__name:"json-diff",setup(e){const t=V(""),s=V(""),n=v(()=>D(()=>J.parse(t.value),void 0)),o=v(()=>D(()=>J.parse(s.value),void 0)),r=f=>Y({source:f,rules:[{validator:u=>u===""||b(()=>J.parse(u)),message:"Invalid JSON"}]}),i=r(t),_=r(s);return(f,u)=>{const m=j,g=F;return k(),A(x,null,[a(g,R({label:"Your first json"},l(i).attrs),{default:p(()=>[a(m,{value:l(t),"onUpdate:value":u[0]||(u[0]=y=>T(t)?t.value=y:null),placeholder:"Paste your first json here...",type:"textarea",rows:"20",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","input-props":{"data-test-id":"leftJson"}},null,8,["value"])]),_:1},16),a(g,R({label:"Your json to compare"},l(_).attrs),{default:p(()=>[a(m,{value:l(s),"onUpdate:value":u[1]||(u[1]=y=>T(s)?s.value=y:null),placeholder:"Paste your json to compare here...",type:"textarea",rows:"20",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","input-props":{"data-test-id":"rightJson"}},null,8,["value"])]),_:1},16),a(ue,{"left-json":l(n),"right-json":l(o)},null,8,["left-json","right-json"])],64)}}});export{he as default};
